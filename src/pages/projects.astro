---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

const dateFormatter = new Intl.DateTimeFormat("en-US", {
    month: "long",
    day: "numeric",
    year: "numeric",
});

const projects = (await getCollection("projects"))
    .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
    .map((project) => ({
        ...project,
        formattedPublishDate: dateFormatter.format(project.data.publishDate),
    }));
---

<Layout
    title="Projects â€” Eliott Wantz"
    description="Selected projects and open-source work."
>
    <!-- Header -->
    <section class="pt-36 pb-12 px-6">
        <div class="max-w-2xl mx-auto">
            <h1
                class="font-display text-5xl sm:text-6xl md:text-7xl font-light text-cream/90"
            >
                Projects
            </h1>
            <p
                class="mt-5 font-display italic text-xl text-muted animate-fade-up"
            >
                Things I&rsquo;ve brought to life
            </p>
        </div>
    </section>

    <!-- Grid -->
    <section class="max-w-3xl mx-auto px-6 pb-32 animate-fade-up" style="animation-delay: 0.12s;">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
            {
                projects.map((project) => (
                    <a
                        href={`/projects/${project.data.slug}`}
                        transition:name={`project-${project.data.slug}`}
                        class="group relative block p-8 border border-rule rounded-sm bg-surface/40
                   hover:border-amber/20 hover:bg-elevated/50
                   transition-all duration-500
                   hover:shadow-[0_0_50px_-12px_rgba(200,150,60,0.07)]"
                        data-reveal
                    >
                        <h2 class="font-display text-2xl text-cream/90 group-hover:text-amber transition-colors duration-300 font-light">
                            {project.data.title}
                        </h2>
                        <p class="mt-3 text-xs tracking-[0.2em] uppercase text-faded">
                            {project.formattedPublishDate}
                        </p>
                        <p class="mt-4 text-[16px] text-justify text-muted leading-[1.85]">
                            {project.data.description}
                        </p>
                        <div class="mt-6 flex flex-wrap gap-2">
                            {project.data.tags.map((tag) => (
                                <span class="text-xs tracking-[0.18em] uppercase text-faded/80 border border-rule/50 px-2.5 py-1 rounded-sm">
                                    {tag}
                                </span>
                            ))}
                        </div>
                    </a>
                ))
            }
        </div>
    </section>
</Layout>
